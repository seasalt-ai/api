{"openapi":"3.1.0","info":{"title":"SeaNotify Webhook API","description":"This API allows clients to subscribe to real-time event notifications via webhooks.","version":"1.0.0"},"paths":{"/notify/api/v1/workspaces/{workspace_id}/subscription":{"post":{"tags":["Subscriptions"],"summary":"Create a Webhook Subscription","description":"Register a new webhook URL to receive notifications for specific event types.","operationId":"create_subscription_notify_api_v1_workspaces__workspace_id__subscription_post","parameters":[{"description":"The ID of the workspace.","required":true,"schema":{"type":"string","title":"Workspace Id","description":"The ID of the workspace."},"example":"ws-a9b8c7d6","name":"workspace_id","in":"path"}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SubscriptionRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SubscriptionResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"callbacks":{"eventWebhook":{"{$request.body#/webhook_url}":{"post":{"summary":"Webhook Event Notification","description":"This is the request your service will send to the client's webhook URL when a subscribed event occurs.","requestBody":{"description":"The event payload. The structure depends on the event type.","required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/EventResponse"}}}},"responses":{"200":{"description":"The client acknowledges receipt of the event successfully."}}}}}}}}},"components":{"schemas":{"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"SubscriptionRequest":{"properties":{"webhook_url":{"type":"string","maxLength":65536,"minLength":1,"format":"uri","title":"Webhook Url","description":"The URL to which event notifications will be sent.","example":"https://api.example.com/my-webhook-handler"},"event_types":{"items":{"type":"string"},"type":"array","title":"Event Types","description":"A list of event types to subscribe to.","example":["conversation.new","message.new"]},"created_by":{"type":"string","title":"Created By","description":"Identifier for the user or system creating the subscription.","example":"user_12345"},"is_enabled":{"type":"boolean","title":"Is Enabled","description":"Set to false to pause sending events.","default":true},"type":{"type":"string","title":"Type","description":"Type of the subscription.","default":"SEASALT","example":"SEASALT"}},"type":"object","required":["webhook_url","event_types","created_by"],"title":"SubscriptionRequest"},"SubscriptionResponse":{"properties":{"subscription_id":{"type":"string","title":"Subscription Id","description":"The unique ID for the created subscription."},"status":{"type":"string","title":"Status","description":"The status of the subscription.","default":"active"},"message":{"type":"string","title":"Message","description":"A confirmation message.","default":"Webhook subscription registered successfully."}},"type":"object","required":["subscription_id"],"title":"SubscriptionResponse"},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"},"SeaNotifyWorkspaceSchema":{"title":"SeaNotifyWorkspaceSchema","type":"object","properties":{"id":{"title":"Id","type":"string"},"name":{"title":"Name","type":"string"}},"required":["id","name"]},"ConversationChannelType":{"title":"ConversationChannelType","description":"An enumeration.","enum":["seax_call","whatsapp","voice","sms","email"],"type":"string"},"SeaNotifySourceSchema":{"title":"SeaNotifySourceSchema","type":"object","properties":{"id":{"title":"Id","type":"string"},"type":{"$ref":"#/components/schemas/ConversationChannelType"},"identifier":{"title":"Identifier","type":"string"}},"required":["id","type","identifier"]},"SeaNotifyCustomerSchema":{"title":"SeaNotifyCustomerSchema","type":"object","properties":{"id":{"title":"Id","type":"string"},"name":{"title":"Name","type":"string"},"email":{"title":"Email","type":"string"},"phone":{"title":"Phone","type":"string"},"channel":{"$ref":"#/components/schemas/ConversationChannelType"},"address":{"title":"Address","type":"string"}},"required":["id","channel"]},"SeaNotifyConversationNewEventDataSchemaBase":{"title":"SeaNotifyConversationNewEventDataSchemaBase","type":"object","properties":{"conversation_id":{"title":"Conversation Id","type":"string"},"conversation_title":{"title":"Conversation Title","type":"string"},"channel":{"$ref":"#/components/schemas/ConversationChannelType"},"customer":{"$ref":"#/components/schemas/SeaNotifyCustomerSchema"}},"required":["conversation_id","conversation_title","channel","customer"]},"SeaNotifyConversationNewEvent":{"title":"SeaNotifyConversationNewEvent","description":"Event schema for a new conversation.","type":"object","properties":{"id":{"title":"Id","type":"string"},"event_time":{"title":"Event Time","description":"The UTC time the event was generated.","type":"string","format":"date-time"},"version":{"title":"Version","type":"string"},"workspace":{"$ref":"#/components/schemas/SeaNotifyWorkspaceSchema"},"source":{"$ref":"#/components/schemas/SeaNotifySourceSchema"},"data":{"$ref":"#/components/schemas/SeaNotifyConversationNewEventDataSchemaBase"}},"required":["id","version","workspace","source","data"]},"ConversationMessageDirection":{"title":"ConversationMessageDirection","description":"An enumeration.","enum":["inbound","outbound"],"type":"string"},"SenderType":{"title":"SenderType","description":"An enumeration.","enum":["customer","agent","bot","system"],"type":"string"},"SeaNotifyMessageNewEventSenderSchema":{"title":"SeaNotifyMessageNewEventSenderSchema","type":"object","properties":{"type":{"$ref":"#/components/schemas/SenderType"},"id":{"title":"Id","type":"string"},"name":{"title":"Name","type":"string"}},"required":["type","id"]},"SeaNotifyMessageNewEventContentSchema":{"title":"SeaNotifyMessageNewEventContentSchema","type":"object","properties":{"type":{"title":"Type","type":"string"},"text":{"title":"Text","type":"string"},"data":{"title":"Data","type":"object"}},"required":["type","text"]},"SeaNotifyMessageNewEventDataSchema":{"title":"SeaNotifyMessageNewEventDataSchema","type":"object","properties":{"conversation_id":{"title":"Conversation Id","type":"string"},"conversation_title":{"title":"Conversation Title","type":"string"},"message_id":{"title":"Message Id","type":"string"},"direction":{"$ref":"#/components/schemas/ConversationMessageDirection"},"created_at":{"title":"Created At","type":"string","format":"date-time"},"sender":{"$ref":"#/components/schemas/SeaNotifyMessageNewEventSenderSchema"},"content":{"$ref":"#/components/schemas/SeaNotifyMessageNewEventContentSchema"}},"required":["conversation_id","conversation_title","message_id","direction","created_at","sender","content"]},"SeaNotifyMessageNewEvent":{"title":"SeaNotifyMessageNewEvent","description":"Event schema for a new message.","type":"object","properties":{"id":{"title":"Id","type":"string"},"event_time":{"title":"Event Time","description":"The UTC time the event was generated.","type":"string","format":"date-time"},"version":{"title":"Version","type":"string"},"workspace":{"$ref":"#/components/schemas/SeaNotifyWorkspaceSchema"},"source":{"$ref":"#/components/schemas/SeaNotifySourceSchema"},"data":{"$ref":"#/components/schemas/SeaNotifyMessageNewEventDataSchema"}},"required":["id","version","workspace","source","data"]},"EventResponse":{"oneOf":[{"$ref":"#/components/schemas/SeaNotifyConversationNewEvent"},{"$ref":"#/components/schemas/SeaNotifyMessageNewEvent"}]}}}}